
{% assign date_format = site.date_format | default: "%B %-d, %Y" %}

<!-- Navbar with Dark Mode Toggle -->
<nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
  <div class="container">
    <a class="navbar-brand" href="{{ site.baseurl }}/">{{ site.title }}</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        {% for link in site.navbar-links %}
          <li class="nav-item">
            <a class="nav-link" href="{{ site.baseurl }}/{{ link[1] }}">{{ link[0] }}</a>
          </li>
        {% endfor %}
        <li class="nav-item">
          <button id="theme-toggle" class="btn btn-sm btn-outline-secondary ms-2">üåô Dark Mode</button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Existing Header Section -->
{% if page.cover-img %}
  <div id="header-big-imgs" data-num-img={% if page.cover-img.first %}{{ page.cover-img.size }}{% else %}1{% endif %}
    {% for bigimg in page.cover-img %}
    {% assign imgnum = forloop.index %}
    {% for imginfo in bigimg %}
    {% if imginfo[0] %}
      data-img-src-{{ imgnum }}="{{ imginfo[0] | absolute_url }}"
      data-img-desc-{{ imgnum }}="{{ imginfo[1] }}"
    {% else %}
      data-img-src-{{ imgnum }}="{{ imginfo | absolute_url }}"
    {% endif %}
    {% endfor %}
    {% endfor %}
  ></div>
{% endif %}

<header class="header-section {% if page.cover-img %}has-img{% endif %}">
<div class="intro-header {% if page.cover-img %} big-img {% endif %}">
  {% if page.cover-img or page.title %}
  <div class="container-md">
    <div class="row">
      <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1">
        <div class="{{ include.type }}-heading">
          <h1>{% if page.title %}{{ page.title | strip_html }}{% else %}<br/>{% endif %}</h1>
          {% if page.subtitle %}
            {% if include.type == "page" %}
              <hr class="small">
              <span class="{{ include.type }}-subheading">{{ page.subtitle | strip_html }}</span>
            {% else %}
              <h2 class="{{ include.type }}-subheading">{{ page.subtitle | strip_html }}</h2>
            {% endif %}
          {% endif %}
          
          {% if include.type == "post" %} 
            {% if page.author %}
              By <strong>{{ page.author | strip_html }}</strong><br>
            {% endif%}
            <span class="post-meta">Posted on {{ page.date | date: date_format }}</span>
            {% if page.last-updated %}
              <span class="post-meta">
                <span class="d-none d-md-inline middot">&middot;</span>
                Last updated {{ page.last-updated | date: date_format }}
              </span>
            {% endif %}
            {% if page.readtime %}
              {% include readtime.html %}
            {% endif %}
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  {% endif %}
  {% if page.cover-img %}<span class='img-desc'></span>{% endif %}
</div>

{% if page.header-extra %}
  {% for file in page.header-extra %}
    {% include {{ file }} %}
  {% endfor %}
{% endif %}
</header>

<!-- Dark Mode Script -->
<script>
  const toggleBtn = document.getElementById("theme-toggle");
  const currentTheme = localStorage.getItem("theme");

  if (currentTheme === "dark") {
    document.body.classList.add("dark-mode");
    toggleBtn.textContent = "‚òÄÔ∏è Light Mode";
  }

  toggleBtn.addEventListener("click", function () {
    document.body.classList.toggle("dark-mode");

    let theme = "light";
    if (document.body.classList.contains("dark-mode")) {
      theme = "dark";
      toggleBtn.textContent = "‚òÄÔ∏è Light Mode";
    } else {
      toggleBtn.textContent = "üåô Dark Mode";
    }
    localStorage.setItem("theme", theme);
  });
</script>

<style>
  body.dark-mode {
    background-color: #121212;
    color: #eaeaea;
  }
  body.dark-mode a {
    color: #bb86fc;
  }
  body.dark-mode .navbar {
    background-color: #1f1f1f !important;
  }
  body.dark-mode .card, 
  body.dark-mode .post-preview, 
  body.dark-mode .header-section {
    background-color: #1f1f1f;
    color: #eaeaea;
  }
</style>
